---
title: "New project setup"
author: "Zaw Myo Tun"
date: "7/12/2020"
output: html_document
---

This document contains code for creating a data analysis project compendium. We will set up the directories and create and configure git and GitHub repositories.

## Load packages

The code below load the necessary packages and install them if they are not found. When prompted options during the installation, choose All option.

```{r}
cran_pkgs <- c(
  "usethis",
  "credentials"
  )

new_pkgs <- cran_pkgs[!sapply(cran_pkgs, require, character.only = TRUE)]
if (length(new_pkgs) != 0) install.packages(new_pkgs)

invisible(sapply(
  c(cran_pkgs),
  library, character.only = TRUE))
```

## Set up folder and documentation structure

1. Create package files

```{r}
usethis::create_package(getwd())
```

2. In DESCRIPTION file, add details of title, author, description

```{r}
file.edit("DESCRIPTION")
```

3. Create a license if necessary

```{r}
usethis::use_mit_license(name = "Zaw Myo Tun")
```

4. Create a folder structure. Edit the structure as necessary.

```{r}
create_analysis <- function() {
  sapply(c(
    "data",
    "data/derived_data",
    "data/raw_data",
    "code",
    "figures"
  ), dir.create)
  
  file.create("data/DO-NOT-EDIT-ANY-FILES-HERE-BY-HAND")
}

invisible(create_analysis())
```

5. Create a README file and add title and other relevant details

```{r}
usethis::use_readme_md()
file.edit(paste0(getwd(), "/README.md"))
```

In `README.md` file, replace the contents with the following.  

-------------------------------------------------------------------
## Title

Write down your title.

## Contents

See [DESCRIPTION](/DESCRIPTION) file to learn more about the project.

The **analysis** directory contains:

- [:file\_folder: manuscript](/manuscript): Manuscript documents
- [:file\_folder: data](/data): Data used in the analysis
- [:file\_folder: code](/code): Analysis code files (`.R` or `.Rmd`)
- [:file\_folder: figures](/figures): Plots and other illustrations

## Lab

[Singapore SLING](http://blog.nus.edu.sg/singaporesling/)  
Infectious diseases, epidemiology, and social networks at the Saw Swee Hock School of Public Health, NUS
-------------------------------------------------------------------

This folder structure is the bare minimum folder structure. You can change the folder structure manually after setting up.  

## Set up Git and GitHub repo

Initialise Git repository and add credential files to .gitignore to prevent the accidental leaking of credentials to GitHub.

```{r}
usethis::use_git()
usethis::git_vaccinate()
```

**Configure Git**

1. Enter user name and email to Git

```{r}
usethis::use_git_config(
  user.name = "Zaw Myo Tun",
  user.email = "zawmyotun11@gmail.com"
)
```


2. Set transport protocol to "https"

```{r}
usethis::use_git_protocol("https")
```

3. Setup GitHub personal access token if not done

```{r}
if (nchar(usethis::github_token()) == 0) credentials::set_github_pat()
```

4. Check the above setups in Git situational report

```{r}
git_sitrep()
```

## Commit files and create remote repository on GitHub

1. Save this file `Control + S`.

2. Open the newly created RStudio project.

```{r}
browseURL("seminarFollowUpData.rproj")
```

3. In the new RStudio window, go to Git tab > select all files > commit. A box will pop up. Write a concise message (e.g. Initial setup files) and press commit.

4. Create a GitHub remote repo and push all files to it. If prompted to check the title and description. Select 'Yup' in the console.

```{r}
usethis::use_github(private = TRUE)
```

Your initial project set up is complete!

If you are collaborating openly and creating a public GitHub repo, you can add a license. Read on!  


## Public repository

```{r}
# Replace your name
usethis::use_ccby_license(name = "<your_name>")
```

Add the following to `README.md`

-------------------------------------------------------------------
## Licensees

**Text and figures:** [CC-BY-4.0](http://creativecommons.org/licenses/by/4.0/)

**Code:** See the [DESCRIPTION](DESCRIPTION) file

**Data:** [CC-0](http://creativecommons.org/publicdomain/zero/1.0/) attribution requested in reuse
-------------------------------------------------------------------


